# 多阶段恶意攻击：利用.JSE和PowerShell部署Agent Tesla与XLoader的威胁分析

## 一、事件概述

  近期，网络安全研究人员发现了一种新型多阶段恶意攻击，通过利用编码的JavaScript文件（.JSE）和PowerShell脚本，成功部署了Agent Tesla变种、Remcos RAT以及XLoader等恶意软件。这种攻击以欺骗性电子邮件为起点，伪装成订单请求，诱导用户打开恶意的7-zip压缩文件附件，随后触发复杂的感染链，利用多层技术躲避传统检测机制。这一事件不仅揭示了攻击者技术的不断进化，也对全球网络安全形势敲响了警钟，尤其是对中国企业及政府机构的信息安全构成了潜在威胁。

## 二、事件描述分析

  根据Palo Alto Networks Unit 42的研究员Saqib Khanzada发布的技术报告，这种多阶段攻击展现了攻击者日益复杂的传播机制和技术手段。下面从攻击的各个阶段、技术特点及其潜在目的进行详细分析。

### 1. 攻击起始：网络钓鱼邮件与.JSE文件
  攻击的初始阶段通过一封伪装成订单请求的网络钓鱼邮件展开，邮件中附带一个恶意的7-zip压缩文件，其中内置一个编码的JavaScript文件（.JSE）。据观察，这一邮件在2024年12月被首次发现，邮件内容谎称已完成付款，诱导收件人打开附件以查看所谓的“订单文件”。这种社会工程学手段利用了用户对商业交易的信任心理，极大地增加了攻击成功率。.JSE文件作为一种经过编码的脚本文件，具有较强的隐蔽性，且不易被传统杀毒软件识别，成为攻击者常用的初始载荷。

### 2. 感染链：从PowerShell到多阶段Dropper
  一旦用户执行.JSE文件，感染链随即启动。该文件作为下载器，从外部服务器下载一个PowerShell脚本。这一脚本包含一个Base64编码的有效载荷，经过解密后会被写入Windows系统的临时目录并执行。接下来，攻击进入下一阶段，加载一个由.NET或AutoIt编译的Dropper。如果是.NET可执行文件，其内置的加密有效载荷（疑为Agent Tesla变种、Snake Keylogger或XLoader）会被解码并注入到“RegAsm.exe”进程中，这是一种已被Agent Tesla攻击活动多次使用的技术手段。而AutoIt编译的可执行文件则进一步增加了分析难度，通过脚本加载最终的Shellcode，将.NET文件注入至“RegSvcs.exe”进程，最终部署Agent Tesla。

### 3. 技术特点：多层攻击链与简单阶段堆叠
  研究员Khanzada指出，这种攻击的显著特点并非高度复杂的混淆技术，而是通过堆叠多个简单阶段构建了一个富有弹性的攻击链。攻击者采用了多种执行路径，既增加了攻击的隐蔽性和成功率，也使安全分析和检测变得更加困难。例如，恶意软件通过注入合法系统进程（如“RegAsm.exe”和“RegSvcs.exe”）来隐藏自身活动轨迹，绕过传统的沙盒环境。这种策略表明，攻击者更倾向于通过模块化的多阶段设计来提升攻击效果，而非依赖单一复杂技术。

### 4. 恶意软件功能与潜在目的
  部署的恶意软件包括Agent Tesla变种、Remcos RAT和XLoader等家族，这些软件均以窃取敏感信息、远程控制受感染系统为主要目的。Agent Tesla以其强大的键盘记录功能和数据窃取能力著称，可捕获用户输入的凭据、浏览记录等信息，并通过加密通道回传给攻击者控制的服务器。XLoader则是一种模块化恶意软件，常用于下载其他恶意载荷或作为间谍工具。而Remcos RAT则提供全面的远程控制功能，使攻击者能够执行文件操作、运行命令甚至监控用户活动。这些恶意软件的结合使用表明，攻击者的目标可能涵盖数据窃取、系统破坏以及持久性访问等多个层面，可能涉及经济利益、政治间谍或其他恶意动机。

### 5. 相关活动：IronHusky与MysterySnail RAT
  除了上述攻击，卡巴斯基还披露了另一场由威胁行为者IronHusky发起的攻击活动，目标锁定蒙古和俄罗斯的政府组织，使用新版本的MysterySnail RAT远程控制木马。该攻击通过恶意的Microsoft管理控制台（MMC）脚本传播，加载一个包含诱饵文档和恶意动态链接库（DLL）的ZIP文件。虽然具体传播途径尚不明确，但其社会工程学手段与.JSE攻击类似，均利用了目标对象的信任心理。MysterySnail RAT具备执行近40条命令的能力，包括文件管理、命令执行及网络连接等功能，显示了攻击者对目标系统的高度控制能力。

  综合来看，这两起攻击事件均体现了多阶段攻击的特点，通过分层设计和模块化载荷提升了攻击的隐蔽性和弹性。无论是.JSE和PowerShell的组合，还是MMC脚本与DLL的搭配，攻击者都展现了利用常见技术和工具进行深度定制的能力，同时借助网络钓鱼等社会工程学手段实现精准打击。

## 三、对我国影响分析研判

  上述多阶段恶意攻击对中国网络安全形势的影响不容忽视。以下从技术、行业和国家战略层面分析其潜在威胁，并研判可能引发的具体风险。

### 1. 技术层面的挑战
  这种多阶段攻击技术的核心在于其隐蔽性和复杂性，传统的安全防护手段如杀毒软件和防火墙难以有效识别此类威胁。特别是通过.JSE文件和PowerShell脚本实现的攻击链，能够轻松绕过签名检测和行为分析，增加了检测和防御难度。对于中国企业而言，尤其是依赖Windows系统的机构，这种攻击可能导致系统权限被提升、敏感数据被窃取，甚至引发供应链攻击。此外，攻击者通过注入合法进程（如“RegAsm.exe”）隐藏恶意活动的技术手段，进一步增加了溯源和清理的难度，可能导致长期潜伏性威胁。

### 2. 行业层面的风险
  从行业角度看，金融、能源、制造和政府部门是此类攻击的首要目标。以金融行业为例，Agent Tesla等恶意软件的键盘记录和凭据窃取功能，可能导致用户账户信息泄露，进而引发经济损失。能源和制造业则面临供应链攻击风险，一旦关键基础设施被感染，可能引发生产中断甚至物理破坏。而政府机构作为信息汇聚中心，更是攻击者觊觎的对象，类似MysterySnail RAT的攻击可能用于窃取涉密信息，威胁国家安全。考虑到中国在全球供应链和信息技术领域的重要地位，这种攻击可能对中国相关行业的稳定性和竞争力产生深远影响。

### 3. 国家战略层面的威胁
  在国家战略层面，多阶段恶意攻击可能被用作网络战的一部分，尤其是针对关键基础设施和政府机构的攻击，可能影响国家安全和社会稳定。近年来，全球范围内针对政府和基础设施的网络攻击频发，类似IronHusky的行为表明，某些攻击背后可能存在国家支持的APT组织（高级持续性威胁组织）。对中国而言，网络空间已成为大国博弈的重要战场，此类攻击可能被用于收集情报、破坏基础设施或制造社会恐慌。此外，攻击者可能通过窃取技术数据和商业机密对中国创新能力和经济增长造成间接威胁。

### 4. 潜在发展趋势与风险评估
  综合分析，未来此类多阶段攻击可能呈现以下趋势：一是攻击技术将更加模块化，攻击链条进一步分散化，以提升弹性和隐蔽性；二是社会工程学手段将更加精准，针对特定行业或个人的定制化网络钓鱼攻击将增加；三是恶意软件功能将更加多样化，结合勒索、间谍和破坏功能，形成多重威胁。基于此，评估认为中国面临的网络安全风险将持续上升，尤其是在数字化转型加速、5G和物联网普及的背景下，攻击面将进一步扩大，防御压力将显著提升。

## 四、应对策略

  针对上述多阶段恶意攻击的特点和对中国的影响，需从技术、组织和政策三个层面制定全面的应对策略，以提升网络安全防护能力，降低潜在威胁。

### 1. 技术层面的防御措施
  首先，应加强端点防护能力，部署基于行为的检测系统，如EDR（端点检测与响应）解决方案，以识别异常进程和文件活动，特别是针对.JSE文件和PowerShell脚本的执行行为。其次，企业需定期更新操作系统和应用软件，修复已知漏洞，避免被攻击者利用权限提升漏洞（如IronHusky使用的CVE-2021-40449） проникновение。再次，建议实施网络分段和最小权限原则，限制恶意软件在系统内的横向移动能力。此外，可利用威胁情报平台实时获取最新攻击技术信息，提前部署防御规则，增强对多阶段攻击的预警能力。

### 2. 组织层面的管理与培训
  在组织层面，企业需加强员工的网络安全意识培训，普及网络钓鱼识别技巧，避免因人为失误导致恶意附件被打开。建议定期开展模拟钓鱼演练，提升员工对社会工程学攻击的警惕性。同时，建立完善的应急响应机制，确保在感染发生后能够快速隔离受影响系统、分析攻击路径并恢复业务。对于政府机构和关键基础设施企业，应设立专门的网络安全团队，负责监控和响应潜在威胁，确保信息系统的连续性和安全性。

### 3. 政策层面的协调与支持
  在政策层面，国家应持续完善网络安全法律法规，明确企业和机构的防护责任，建立跨部门、跨行业的协同防御机制。例如，可通过国家网络安全应急中心（CNCERT）协调资源，应对大规模网络攻击事件。此外，政府应加大对自主可控技术的研发支持，推动国产安全产品替代国外软件，降低对外部技术的依赖风险。同时，鼓励企业与研究机构合作，共同研发针对多阶段攻击的检测和防御技术，提升整体网络安全水平。

### 4. 国际合作与情报共享
  鉴于网络攻击的跨境性，中国应积极参与国际网络安全合作，与其他国家、国际组织共享威胁情报，共同应对全球性网络威胁。例如，可通过参与国际网络安全峰会、加入威胁情报共享平台（如ISAC和ISAO），获取最新的攻击技术和防御策略，从而更好地保护国内网络空间。

## 五、结论

  综上所述，利用.JSE和PowerShell部署Agent Tesla与XLoader的多阶段恶意攻击，体现了网络威胁的复杂性和隐蔽性，其技术手段和社会工程学策略对全球网络安全构成了严峻挑战。对中国而言，这种攻击不仅威胁企业数据安全和行业稳定性，更可能影响国家战略利益。为此，必须从技术、组织和政策层面采取综合措施，构建多层次防御体系，提升网络空间的韧性和安全性。只有通过政府、企业和国际社会的共同努力，才能有效应对此类新型网络威胁，确保数字经济和国家安全的可持续发展。

**出处：** 本文参考了安全KER资讯平台发布的文章《多阶段恶意攻击利用.JSE 和 PowerShell 部署 Agent Tesla 与 XLoader 恶意软件》，原文翻译自TheHackersNews，原文链接：https://thehackernews.com/2025/04/multi-stage-malware-attack-uses-jse-and.html。如若转载，请注明出处。