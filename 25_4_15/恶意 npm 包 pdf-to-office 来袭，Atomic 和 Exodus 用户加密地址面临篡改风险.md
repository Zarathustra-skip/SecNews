**恶意 npm 包 pdf-to-office 事件分析：从中国视角看影响与应对**

**一、事件概述**

2025年4月，安全资讯平台“安全KER”报道了一起针对加密货币用户的软件供应链攻击事件。威胁行为者通过 npm（Node Package Manager，Node.js 包管理器）注册表上传了一个名为“pdf-to-office”的恶意软件包。该软件包伪装成一款将 PDF 文件转换为 Microsoft Word 文档的实用工具，实则暗藏恶意代码，专门针对 Atomic Wallet 和 Exodus 两款加密货币钱包软件，篡改用户资金转账的目标地址，将资金导向攻击者的钱包。此事件不仅暴露了软件供应链攻击的隐蔽性和持久性，也对全球加密货币用户及相关行业敲响了警钟。从中国视角来看，此类攻击可能对国内加密货币用户、开发者及相关企业造成潜在威胁，亟需深入分析其影响并制定应对策略。

**二、事件描述与分析**

1. **事件背景与发现过程**

根据“安全KER”翻译自 The Hacker News 的报道，威胁行为者近年来持续利用 npm 注册表作为攻击载体，通过上传恶意软件包篡改本地合法库版本，执行恶意代码。这种攻击方式被认为是软件供应链攻击的一种隐蔽形式，具有较高的技术复杂性和持久性。2025年3月24日，名为“pdf-to-office”的软件包首次发布，并于4月8日更新至1.1.2版本，截至报道时已被下载334次。尽管下载量看似不多，但其潜在危害不容小觑。安全公司 ReversingLabs 的研究员 Lucija Valentić 指出，该软件包针对的是特定版本的 Atomic Wallet（2.91.5 和 2.90.6）和 Exodus（25.13.3 和 25.9.2）加密货币钱包软件，攻击者通过精准覆盖相关 JavaScript 文件，实现对用户加密地址的篡改。

2. **攻击机制与技术细节**

“pdf-to-office”软件包的攻击机制具有高度针对性。其恶意代码会检查目标 Windows 计算机上是否存在 Atomic Wallet 的特定归档文件（“atomic/resources/app.asar”）或 Exodus 钱包的相关文件（“src/app/ui/index.js”）。一旦确认目标软件存在，恶意代码会用篡改后的文件覆盖原始文件，将用户转账时的目标地址替换为攻击者控制的、经过 Base64 编码的 Web3 钱包地址。这种攻击方式的隐蔽性在于，即使用户卸载了“pdf-to-office”软件包，钱包软件中的篡改文件依然存在，继续将资金导向攻击者账户，唯一的解决办法是完全卸载并重新安装钱包软件。

此外，攻击者对目标软件版本的精准选择也显示出其对目标系统的深入研究和攻击准备。这种攻击不仅针对最终用户，还通过软件供应链渗透开发者环境，进一步扩大了潜在受害者范围。值得注意的是，类似攻击并非孤立事件。报道中提到，ReversingLabs 此前还发现了“ethers-provider2”和“ethers-providerz”等恶意 npm 软件包，这些软件包通过建立反向 Shell 与攻击者服务器通信，显示出软件供应链攻击的多样性和复杂性。

3. **相关攻击与趋势**

除了“pdf-to-office”事件，报道还提及了 ExtensionTotal 披露的10个恶意 Visual Studio Code 扩展程序，这些扩展程序在被下架前总计被安装超过一百万次。它们通过下载 PowerShell 脚本，禁用 Windows 安全功能并安装 XMRig 加密货币挖矿程序，显示出攻击者利用开发工具和扩展程序进行恶意活动的趋势。这些事件共同揭示了软件供应链攻击的普遍性和多样性，攻击者不仅针对特定软件包，还通过伪装成合法工具或扩展程序，降低用户警惕性，实施多阶段攻击。

4. **事件特点与意义**

从技术角度看，“pdf-to-office”事件具有以下特点：一是攻击隐蔽性强，伪装成实用工具降低用户怀疑；二是持久性高，即使恶意软件包被删除，篡改文件依然生效；三是针对性强，精准攻击特定版本的加密货币钱包软件。从行业意义上看，此事件进一步凸显了软件供应链安全的重要性。npm 作为全球开发者广泛使用的包管理平台，其安全漏洞可能影响数以百万计的开发者和用户。而加密货币作为一种高价值数字资产，其安全问题直接关系到用户财产安全和行业信任。此类攻击的出现，表明威胁行为者正在将攻击目标从传统网络钓鱼转向更具技术含量的软件供应链攻击，未来类似事件可能更加频繁和复杂。

**三、对我国影响分析研判**

1. **对国内加密货币用户的直接影响**

尽管“pdf-to-office”事件主要针对 Atomic Wallet 和 Exodus 两款钱包软件，且目前未见直接针对中国用户的攻击案例，但其潜在影响不容忽视。中国作为全球加密货币交易和挖矿的重要市场，拥有大量加密货币用户和投资者。国内用户中不乏使用国际主流钱包软件（如 Atomic Wallet 和 Exodus）的情况，一旦这些用户在不知情的情况下安装了恶意软件包，其加密货币资产将面临被盗风险。此外，由于加密货币交易的匿名性和不可逆性，一旦资金被转移至攻击者账户，追回的可能性极低，这将对用户造成重大经济损失。

2. **对国内开发者和软件供应链的间接影响**

中国拥有庞大的开发者群体，许多开发者依赖 npm 等开源平台获取代码库和工具包。恶意软件包的出现可能通过开发环境渗透至国内企业或个人开发者，进而影响其开发的产品或服务。虽然“pdf-to-office”事件针对的是加密货币钱包，但类似攻击手法可能被复制到其他领域，威胁国内软件供应链安全。例如，攻击者可能针对国内主流开发工具或框架发布恶意软件包，影响企业应用开发，甚至波及关键基础设施领域。

3. **对国内加密货币行业和监管环境的潜在冲击**

近年来，中国政府对加密货币行业的监管力度不断加强，旨在防范金融风险和非法活动。然而，此类软件供应链攻击可能绕过传统监管手段，直接威胁用户资产安全，进而影响行业信任和市场稳定。如果类似攻击在国内大规模发生，可能引发公众对加密货币安全性的质疑，进一步加剧监管压力。此外，由于加密货币的跨境特性，此类攻击可能涉及国际黑客组织或跨境犯罪团伙，增加国内执法和网络安全部门的应对难度。

4. **对网络安全产业和国际合作的影响**

从网络安全产业角度看，“pdf-to-office”事件为国内安全厂商提供了新的研究方向和市场机遇，但也带来了挑战。国内安全企业需要在软件供应链安全领域投入更多资源，开发针对恶意软件包的检测和防御技术。同时，此类攻击的全球性特点要求加强国际合作，共享威胁情报和应对经验。然而，由于地缘政治和数据主权等因素，国际合作可能面临一定障碍，国内需在自主创新和国际协作之间找到平衡。

**四、应对策略**

1. **用户层面的防护措施**

针对国内加密货币用户，应加强安全意识教育，采取以下措施：一是谨慎下载和使用第三方软件包或工具，尤其是在 npm 等开源平台上，应优先选择官方或经过验证的软件包；二是定期更新钱包软件至最新版本，避免使用易受攻击的旧版本；三是使用硬件钱包或冷存储方式存储加密货币资产，减少在线钱包被攻击的风险；四是安装并定期更新杀毒软件和安全工具，及时检测和清除潜在恶意代码；五是一旦发现异常交易或地址篡改，应立即停止使用相关软件，并联系专业安全团队进行排查。

2. **开发者与企业层面的安全管理**

对于国内开发者及企业，应加强软件供应链安全管理：一是建立严格的软件包审核机制，在引入第三方库或工具前进行安全扫描和来源验证；二是部署代码签名和完整性校验机制，确保代码未被篡改；三是加强对开发环境的保护，避免恶意软件通过开发工具或扩展程序渗透；四是定期开展安全培训，提升开发人员对软件供应链攻击的认知和防御能力；五是与安全厂商合作，引入专业的威胁情报和检测服务，及时发现潜在风险。

3. **行业与监管层面的协同应对**

在行业和监管层面，需构建多方协同的防御体系：一是行业协会和企业应联合建立软件供应链安全标准，规范开源软件包的发布和使用流程；二是监管部门可推动建立恶意软件包的预警和通报机制，及时向公众和企业发布安全提示；三是加强与国际安全组织和平台的合作，共享威胁情报，共同应对跨境网络攻击；四是针对加密货币行业，监管部门可探索引入强制性安全审计机制，要求钱包软件提供商定期接受安全评估；五是加大对网络犯罪的打击力度，联合执法部门追踪和惩处恶意软件包的发布者和攻击者。

4. **技术创新与自主研发**

从长远看，国内需加大网络安全技术创新和自主研发力度：一是开发针对软件供应链攻击的检测工具和防御系统，提升对恶意软件包的识别能力；二是推动国产化开发工具和包管理平台的建设，减少对国外平台的依赖；三是支持安全企业开展软件供应链安全研究，构建覆盖全生命周期的安全防护体系；四是鼓励产学研合作，培养网络安全领域的高端人才，为应对新型攻击提供智力支持。

**五、结论**

“pdf-to-office”恶意 npm 包事件揭示了软件供应链攻击的隐蔽性和破坏性，对全球加密货币用户和开发者构成了严重威胁。从中国视角看，尽管目前未见直接针对国内用户的攻击案例，但其潜在影响涉及用户资产安全、软件供应链稳定、行业信任及监管环境等多个层面。为有效应对此类威胁，需从用户、开发者、企业、行业及监管等多个层面采取综合措施，加强安全意识教育、技术防护、行业协作及国际合作。同时，国内应抓住机遇，推动网络安全技术创新和自主研发，构建更加安全可靠的数字生态。只有通过多方协同和持续努力，才能有效降低软件供应链攻击的风险，保障国内用户和企业的网络安全。

**六、出处**

本文内容基于“安全KER - 安全资讯平台”发布的文章《恶意 npm 包 pdf-to-office 来袭，Atomic 和 Exodus 用户加密地址面临篡改风险》，原文翻译自 The Hacker News，原文链接：https://thehackernews.com/2025/04/malicious-npm-package-targets-atomic.html。