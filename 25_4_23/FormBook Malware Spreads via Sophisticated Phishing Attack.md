# 网络钓鱼新威胁：FormBook恶意软件攻击分析与应对

### 一、事件概述

近期，Fortinet的FortiGuard Labs揭露了一场针对Windows用户的新型网络钓鱼活动，该活动通过伪装成销售订单的恶意电子邮件和武器化的Word文档传播FormBook信息窃取恶意软件。攻击者结合社会工程学、微软旧版漏洞（CVE-2017-11882）以及先进的规避技术，推送了一种无文件形式的FormBook变种。这种恶意软件以其持久性和隐蔽性成为网络安全领域的一大威胁。本文将对此次攻击事件进行深入分析，探讨其对中国可能产生的影响，并提出有效的应对策略，为相关机构和个人提供参考。

### 二、事件描述分析

#### 1. 攻击链条详解

此次网络钓鱼活动的攻击链条设计精巧，充分体现了攻击者对社会工程学和漏洞利用的熟练掌握。首先，攻击者通过伪装成销售订单的电子邮件诱导目标用户打开附件中的Word文档（命名为order0087.docx）。这种伪装手段利用了用户对日常商务邮件的信任心理，具有极高的迷惑性。一旦用户打开文档，攻击链条随即启动，文档利用altChunk特性自动加载一个嵌入的RTF文件（名为Algeria.rtf），从而触发恶意行为。

Algeria.rtf文件经过高度混淆，内含利用CVE-2017-11882漏洞的恶意负载。该漏洞是针对Microsoft Equation Editor 3.0的远程代码执行漏洞，攻击者通过引发缓冲区溢出，最终执行命令“CmD.exe /C rundll32 %tmp%\AdobeID.pdf,IEX A”。这一命令将一个名为AdobeID.pdf的64位DLL文件提取至临时文件夹，并通过rundll32.exe执行。AdobeID.pdf并非普通的加载器，而是一个多功能组件，负责建立持久性、下载真正的FormBook负载，并完全在内存中执行恶意代码，避免留下磁盘痕迹。

#### 2. 持久性与负载下载机制

攻击者通过在注册表中设置一个键值（HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\RtkAudUService）来实现恶意软件的持久性，确保系统重启后恶意代码依然能够运行。随后，FormBook的实际负载从一个伪装成PNG格式的文件（网址为hxxps://www2[.]0zz0[.]com/2025/02/02/10/709869215.png）下载。尽管文件扩展名为.png，但Fortinet的研究表明其内容经过加密，恶意软件通过硬编码的解密密钥（H1OX2WsqMLPKvGkQ）将其解密为FormBook的可执行文件。

#### 3. 无文件执行与进程注入技术

解密后的FormBook通过进程掏空（process hollowing）技术注入到一个合法的Windows进程——ImagingDevices.exe中。这种技术允许恶意软件在不写入磁盘的情况下运行，从而规避传统防病毒工具的检测。具体而言，恶意软件创建一个目标进程的挂起实例，利用NtMapViewOfSection()函数将FormBook负载替换到进程内存中，随后通过Wow64SetThreadContext()和NtResumeThread()操控线程上下文恢复进程执行。Fortinet指出，FormBook的基本地址为0x6E0000，并通过调用RtlUserThreadStart() API在新建线程中运行其负载，进一步增强隐蔽性。

#### 4. 攻击特点与技术创新

此次攻击展现了攻击者在技术上的多重创新。首先，结合社会工程学与旧版漏洞利用，攻击者成功降低了用户的警惕性。其次，无文件执行和プロセス注入技术的应用，使得传统基于文件签名的检测手段失效。此外，伪装成PNG文件的负载下载机制以及硬编码解密密钥的使用，进一步提升了攻击的隐蔽性和对抗性。这些特点表明，FormBook已从传统的信息窃取工具演变为高度模块化、难以追踪的恶意软件。

#### 5. 潜在目标与危害性

FormBook作为一种信息窃取恶意软件，其主要目标是窃取用户的敏感数据，包括但不限于登录凭据、银行账户信息、浏览记录以及键盘输入记录等。其隐蔽性和持久性使其成为网络犯罪团伙的首选工具，可能被用于数据贩卖、勒索软件部署或更复杂的APT（高级持续性威胁）攻击。针对Windows用户的广泛性也意味着此次攻击可能影响到全球范围内的个人用户和企业组织。

### 三、对中国的可能影响分析研判

#### 1. 中国用户与企业的广泛曝光风险

中国作为全球最大的Windows用户市场之一，拥有庞大的个人用户和企业用户群体。此次FormBook攻击主要通过电子邮件传播，结合社会工程学手段，对中国用户构成显著威胁。尤其是在中小企业和部分政府机构中，由于网络安全意识和防护措施相对薄弱，员工可能更容易因缺乏培训而点击恶意附件，从而导致感染。此外，中国的电子商务和跨境贸易活动频繁，伪装成销售订单的钓鱼邮件可能更容易获得目标用户的信任，增加攻击成功率。

#### 2. 关键行业的潜在威胁

FormBook攻击可能对中国的关键行业，如金融、制造业和信息技术领域，造成严重威胁。金融行业由于涉及大量敏感数据和资金交易，通常是信息窃取恶意软件的首要目标。一旦银行或支付机构的系统被感染，用户的账户信息可能被窃取，导致资金损失和信任危机。制造业则面临供应链安全风险，攻击者可能利用感染的系统窃取知识产权或干扰生产流程。而信息技术行业作为数字化转型的核心，一旦核心系统被感染，可能引发大规模数据泄露或服务中断。

#### 3. 旧版软件与漏洞管理的挑战

CVE-2017-11882漏洞作为此次攻击的核心利用点，暴露出中国部分组织在软件更新和漏洞管理方面的不足。尽管该漏洞已于2017年公布并有相应补丁，但仍有大量企业和个人未能及时更新系统，尤其是一些使用旧版Microsoft Office的组织。这种情况在资源有限的中小企业中尤为普遍，攻击者可能借此大规模感染目标系统。此外，部分组织可能因业务连续性需求而禁用自动更新，进一步增加了被攻击的风险。

#### 4. 网络安全基础设施的压力

此次攻击的无文件执行和プロセス注入技术对传统的网络安全基础设施提出了严峻挑战。中国的网络安全行业虽然近年来取得了长足进步，但部分企业仍在依赖基于签名的防病毒软件，而这些工具对FormBook的无文件变种基本无效。此外，攻击者使用加密的PNG文件作为负载下载媒介，绕过常规的网关检测，进一步加剧了防守难度。对中国网络安全企业而言，这意味着需要在行为检测、内存分析以及威胁情报共享等方面投入更多资源。

#### 5. 社会经济影响与数据安全风险

从更广的层面看，FormBook攻击可能对中国社会经济稳定和数据安全造成深远影响。信息泄露可能导致个人隐私受损，企业和政府机构的数据泄露则可能引发公众信任危机。此外，若攻击者将窃取的数据用于勒索或在暗网交易，可能进一步放大经济损失。尤其是在当前国际网络安全形势紧张的背景下，此类攻击可能被某些国家或组织利用，成为网络战的一部分，对中国国家安全构成潜在威胁。

### 四、应对策略

#### 1. 加强用户安全意识教育

针对社会工程学攻击的特点，首要任务是提高用户的网络安全意识。政府、企业和学校应定期开展网络安全培训，教育用户辨识钓鱼邮件的特征，如不明附件、紧急语气或伪装身份等。对于企业而言，可通过模拟钓鱼测试评估员工的应变能力，并针对薄弱环节提供专项指导。此外，政府可通过公共媒体和网络平台发布安全提示，提醒广大用户在处理电子邮件时保持警惕，尤其是在涉及附件或链接的情况下。

#### 2. 加速软件更新与漏洞修复

针对CVE-2017-11882等旧版漏洞的利用，企业和个人应立即检查并更新Microsoft Office及其他相关软件，确保安装最新的安全补丁。对于无法及时更新的系统，建议禁用高风险组件，如Microsoft Equation Editor，以降低被攻击的可能性。政府和行业协会可推动漏洞管理标准化，要求关键行业和公共部门定期进行漏洞扫描和风险评估，确保系统安全。此外，可建立漏洞修复激励机制，鼓励中小企业加速系统更新。

#### 3. 部署先进的防御技术

传统的防病毒软件对无文件恶意软件的检测能力有限，因此企业和组织需要部署基于行为分析和机器学习的下一代安全解决方案。这些方案可以通过监控异常进程行为、内存操作以及网络流量，及时发现FormBook等恶意软件的活动。同时，建议企业在邮件网关处部署沙箱技术，用于检测和隔离可疑附件。此外，终端检测与响应（EDR）工具可提供更全面的威胁可见性，帮助安全团队快速响应潜在感染。

#### 4. 加强威胁情报共享与国际合作

FormBook攻击的全球性特征表明，单一国家或组织难以独立应对此类威胁。中国应加强与国际网络安全社区的合作，参与威胁情报共享平台，获取最新的恶意软件样本和攻击技术情报。同时，国内网络安全企业、政府部门和研究机构应建立高效的情报共享机制，及时发布预警信息，协助各行业应对新型威胁。此外，可通过国际合作打击网络犯罪团伙，追查FormBook背后的指挥与控制（C2）基础设施，切断攻击者的资源链。

#### 5. 完善法律法规与应急响应机制

政府应加快制定和完善针对网络钓鱼和恶意软件攻击的相关法律法规，明确企业的数据保护责任和处罚机制。对于关键基础设施和重要行业，可强制要求其定期进行安全审计，并建立网络攻击应急响应预案。同时，建议建立国家级网络安全应急中心，负责协调重大网络安全事件的响应与处理，提供技术支持和资源调配。对于个人用户，可通过立法加强对隐私数据的保护，增加攻击者的违法成本。

#### 6. 推动网络安全产业自主创新

针对FormBook攻击暴露出的技术短板，中国网络安全产业应加大自主研发力度，特别是在内存分析、行为检测和无文件恶意软件防御领域。同时，政府可通过政策支持和财政补贴，鼓励企业开发适应新型威胁的安全产品。此外，应加强产学研合作，将学术研究的前沿成果快速转化为实际应用，提升整体防御能力。通过自主创新，中国可在全球网络安全竞争中占据更有利的位置。

### 五、结论

此次FormBook信息窃取恶意软件的网络钓鱼活动揭示了网络安全威胁的复杂性和多样性。攻击者通过社会工程学、旧版漏洞利用以及无文件执行技术，成功绕过传统防御机制，对全球Windows用户构成了严重威胁。对于中国而言，由于用户群体庞大、行业数字化程度高以及部分安全基础设施的不足，此类攻击可能带来个人隐私泄露、企业数据损失以及社会经济稳定等多重风险。为应对这一挑战，需从用户教育、软件更新、技术防御、情报共享、法律完善以及产业创新等多个层面入手，构建多层次的网络安全防护体系。只有通过全社会共同努力，才能有效降低FormBook等恶意软件的危害，保障数字空间的安全与稳定。在未来的网络安全斗争中，中国应以此次事件为契机，加速提升自身防御能力，为构建安全的网络环境贡献力量。

**出处来源**：  
Fortinet’s FortiGuard Labs report on the new phishing campaign distributing FormBook infostealer malware.