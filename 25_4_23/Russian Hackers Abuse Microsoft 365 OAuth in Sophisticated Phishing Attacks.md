# 俄罗斯威胁行为者针对微软365的社交工程攻击分析

## 一、事件概述

近期，网络安全公司Volexity发布了一份报告，披露了疑似俄罗斯威胁行为者（被追踪为UTA0352和UTA0355）针对微软365（M365）OAuth认证流程发起的一系列高级社交工程攻击。这些攻击活动自2025年3月开始，利用微软合法认证基础设施，通过精密的钓鱼技术获取受害者账户的未经授权访问权限。攻击者通过伪装成外交官或政府官员，借助安全消息应用程序（如Signal和WhatsApp）以及伪造的视频会议邀请，诱骗目标提供OAuth授权代码，从而访问其M365资源，包括电子邮件、文件和其他协作数据。这种攻击方式滥用了微软OAuth实施的合法功能，使得传统防御机制难以奏效，具有极高的隐蔽性和危害性。

## 二、事件描述分析

### 1. 攻击背景与动机
根据Volexity的报告，这些攻击活动涉及至少两个疑似俄罗斯威胁行为者——UTA0352和UTA0355，其攻击手法展示了社交工程技术的显著进化。这些攻击者并非通过传统的恶意软件或伪造网站实施钓鱼，而是利用了微软自身的OAuth认证流程，这一流程本是用于安全验证用户身份和授权第三方应用访问资源的机制。这种攻击方式的独特性在于其“合法性”——受害者全程仅与微软的官方服务交互，因而极易放松警惕。

攻击者的主要动机似乎是获取敏感信息，特别是与乌克兰冲突相关的数据。目标群体包括政府官员、非政府组织（NGO）以及人权倡导者，这些群体往往持有高度敏感的信息资源。通过获取受害者的M365账户访问权限，攻击者能够接触到电子邮件、文件以及其他协作数据，可能用于情报收集、間谍活动或进一步的网络攻击。

### 2. 攻击手法解析
#### UTA0352的手法：直接窃取OAuth代码
UTA0352主要通过安全消息应用（如Signal和WhatsApp）进行社交工程，冒充外交官或政府官员，邀请受害者参与讨论敏感话题（尤其是乌克兰冲突）的虚假视频会议。在这一过程中，攻击者向受害者发送包含微软OAuth URL的链接，诱导其点击并返回生成的授权代码。例如，攻击者曾伪装成“罗马尼亚外交部”，向目标发送PDF格式的指导文件，内含类似以下的URL：
```
https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize?...&redirect_uri=https://insiders.vscode.dev/redirect
```
这些链接指向微软的自有服务（如Visual Studio Code），看似合法，但实际上被设计为在浏览器地址栏或对话窗口中暴露OAuth授权代码。一旦受害者将代码提供给攻击者，攻击者即可将其兑换为访问令牌，从而获得对受害者M365资源的完全访问权限。这一授权代码的有效期长达60天，足以让攻击者深入挖掘受害者的电子邮件、文件及其他敏感数据。

Volexity特别指出，这种攻击的关键在于受害者必须主动将代码返回给攻击者，单纯点击链接并不会直接导致权限泄露。这种手法充分利用了用户对微软服务的信任心理，使得攻击过程显得更加“自然”。

#### UTA0355的手法：多阶段设备注册攻击
相比之下，UTA0355采用了更为复杂的多阶段攻击策略。其攻击始于利用已遭入侵的乌克兰政府电子邮件账户向目标（主要是NGO和人权倡导者）发送初始电子邮件，随后通过Signal或WhatsApp进一步进行社交工程。与UTA0352不同，UTA0355并未直接追求Graph API访问权限，而是针对微软Entra ID（原Azure AD）中的设备注册服务，尝试将新设备注册到受害者的身份下。

在这一过程中，攻击者会通过社交工程手段诱导受害者批准二次验证（2FA）请求，从而获得对目标电子邮件账户的完全控制权。Volexity报告显示，在攻击成功后，攻击者会从新注册的设备上下载受害者的电子邮件内容。这种手法不仅隐蔽性更高，还能在受害者不知情的情况下长期维持访问权限，进一步扩大攻击的影响范围。

### 3. 攻击特点与挑战
这两个威胁行为者的攻击手法有以下几个显著特点：
- **滥用合法基础设施**：攻击全程依赖微软的自有服务（如OAuth认证流程和Visual Studio Code接口），未涉及任何外部恶意网站或软件。这种“合法性”使得传统的钓鱼检测工具（如URL黑名单或恶意软件扫描）几乎失效。
- **社交工程的高级化**：攻击者通过精心设计的身份伪装和敏感话题（如乌克兰冲突），有效降低了受害者的戒备心理。这种针对性极强的社交工程手法对目标群体的心理把握极为精准。
- **隐蔽性和持久性**：OAuth授权代码的有效期长达60天，且设备注册攻击可能在受害者无察觉的情况下持续进行，为攻击者提供了充足的时间窃取数据或进行其他恶意活动。
- **检测与防御难度大**：由于攻击流程完全基于合法服务，传统的网络安全解决方案（如防火墙或反病毒软件）难以有效识别和拦截。

Volexity特别警告称，“受害者仅需与合法的微软365服务互动，而用户往往会天然信任这些服务”，这正是此类攻击难以防范的核心原因。

## 三、对我国（中国）影响分析研判

### 1. 潜在风险评估
尽管Volexity报告中所述的攻击主要针对与乌克兰冲突相关的特定群体，但其技术手段和攻击模式对我国同样构成显著威胁。我国作为全球重要的网络空间参与者，拥有大量政府机构、企业和个人用户依赖微软365等云服务进行日常办公和数据协作。这些用户中不乏持有敏感信息的目标群体，如政府部门、科研机构、跨国企业以及社会活动人士，他们可能成为类似攻击的潜在目标。

首先，从攻击对象的角度看，UTA0352和UTA0355的目标选择显示出高度的针对性和地缘政治动机。尽管当前攻击聚焦于乌克兰议题，但随着国际形势的变化，类似攻击可能转向其他热点地区或国家，包括涉及我国利益的议题。例如，涉及“一带一路”倡议、贸易谈判、科技竞争等敏感领域的信息可能成为攻击者的目标。此时，攻击者可能伪装为相关领域的官员或专家，诱导我国用户泄露OAuth代码或批准设备注册。

其次，从技术角度看，这种基于OAuth流程的攻击具有普适性。我国大量用户和组织依赖微软365进行电子邮件、文件共享和团队协作，OAuth认证流程同样广泛应用于这些场景。攻击者若将类似手法用于针对我国用户，可能通过伪造紧急会议邀请、政策文件共享等方式，诱导用户点击链接并提供授权代码。由于攻击全程基于微软合法服务，我国现有的网络安全防御体系可能难以有效识别和拦截。

最后，从影响范围看，一旦攻击成功，受害者的电子邮件、文件及其他协作数据可能被全面窃取。这不仅会导致敏感信息泄露，还可能引发连锁反应，例如利用窃取的信息进行进一步的钓鱼攻击、勒索软件投放或供应链攻击。对于政府机构而言，信息泄露可能威胁国家安全；对于企业而言，则可能导致商业机密流失和经济损失。

### 2. 现有防御能力的不足
目前，我国在网络安全领域已建立了较为完善的防御体系，包括国家级网络安全应急响应机制、企业级安全解决方案以及用户教育培训。然而，针对此类高级社交工程攻击，现有防御能力仍存在以下不足：
- **技术检测局限**：传统的网络安全工具主要针对恶意网址、恶意软件或异常流量进行检测，但对基于合法OAuth流程的攻击缺乏有效的识别机制。即使部署了高级威胁检测系统，也可能因攻击流程的“合法性”而漏报。
- **用户意识不足**：尽管近年来网络安全宣传力度加大，但普通用户（甚至部分政府和企业员工）对社交工程攻击的认知仍显不足。特别是在涉及看似紧急或敏感的沟通场景下，用户往往优先响应而忽视安全检查。
- **政策与管理滞后**：虽然我国对云服务安全有一定管理规范，但针对OAuth认证流程的具体安全策略尚未普及。例如，缺乏对异常设备注册的有效监控，或对高风险OAuth客户端ID的统一限制。

### 3. 影响深远性分析
此类攻击若在我国发生，可能带来多层次的影响。首先是信息安全层面，敏感数据的泄露可能直接威胁国家安全和商业利益。其次是信任层面，用户对云服务的信任可能因此下降，影响数字化转型进程。最后是国际合作层面，若攻击涉及跨国组织或政府部门，可能引发外交纠纷或国际信任危机。因此，及时研判和应对此类威胁对我国网络安全体系至关重要。

## 四、应对策略

针对上述分析，我国需要在技术、管理和教育多个层面采取综合应对措施，以降低类似攻击的风险并提升整体防御能力。以下是具体建议：

### 1. 技术层面的防御改进
- **加强OAuth流程监控**：借鉴Volexity的建议，针对特定高风险OAuth客户端ID（如报告中提到的aebc6443-996d-45c2-90f0-388ff96faa56）进行实时监控，识别并告警带有可疑重定向URI的认证请求。同时，建议企业在微软Entra ID中监控异常设备注册行为，及时发现未经授权的设备绑定。
- **限制可疑服务访问**：对于非必要场景，建议组织屏蔽报告中提到的可疑服务域名，如insiders.vscode.dev和vscode-redirect.azurewebsites.net，以降低攻击者利用这些服务窃取授权代码的风险。
- **部署条件访问策略**：在微软365环境中实施条件访问政策，限制访问权限仅限于已批准或受管理的设备。通过结合设备合规性检查和地理位置限制，减少未经授权设备访问账户的可能性。
- **增强二次验证机制**：尽管部分攻击涉及诱导用户批准2FA请求，但强化2FA提示的可视化信息（如明确显示请求来源设备和位置）可帮助用户识别异常请求。

### 2. 管理层面的政策完善
- **制定OAuth安全规范**：政府和行业监管部门应制定针对OAuth认证流程的具体安全指南，明确组织在使用云服务时应遵循的最佳实践，包括授权代码保护、异常行为审计等内容。
- **强化云服务合规审查**：对依赖微软365等海外云服务的组织，建议加强合规性审查，要求服务提供商提供详细的安全日志和异常告警机制，同时鼓励优先使用符合本地化的云服务解决方案。
- **建立应急响应机制**：针对类似攻击，建议建立快速响应团队，负责在攻击发生后迅速锁定受影响账户、撤销授权代码并开展溯源分析，以减少进一步损失。

### 3. 用户教育与意识提升
- **加强社交工程防范培训**：面向政府机构、企业员工和普通用户，定期开展网络安全培训，重点讲解社交工程攻击的常见手法和识别技巧。例如，提醒用户警惕通过即时通讯工具发送的未预期的认证请求或会议邀请。
- **推广安全行为准则**：鼓励用户养成良好的安全习惯，如不轻易将任何代码或认证信息分享给第三方，即使请求看似来自可信来源；同时建议在收到可疑请求时主动联系官方渠道核实。
- **提高对云服务的认知**：通过宣传活动提升用户对云服务认证流程的理解，帮助其认识到即便是合法服务也可能被滥用，培养在操作敏感流程时的谨慎态度。

### 4. 国际合作与信息共享
- **加强国际网络安全协作**：与国际网络安全组织和企业（如Volexity、微软等）建立信息共享机制，及时获取最新威胁情报，特别是针对跨国威胁行为者的攻击模式和技术手段。
- **参与全球标准制定**：积极参与国际云服务安全标准的制定，推动对OAuth等认证机制的安全改进，从源头上减少被滥用的风险。

## 五、结论

Volexity披露的俄罗斯威胁行为者针对微软365 OAuth认证流程的社交工程攻击，标志着网络钓鱼技术向更隐蔽、更复杂方向的演进。通过滥用合法认证基础设施，攻击者成功绕过了传统防御机制，对全球用户构成了严重威胁。尽管当前攻击主要针对特定地缘政治议题相关群体，但其技术手段具有普适性，对我国政府、企业和个人用户同样构成潜在风险。攻击可能导致敏感信息泄露、信任危机以及更广泛的网络安全挑战。

面对这一威胁，我国需要在技术防御、管理政策和用户教育等方面采取多维度应对措施。通过加强OAuth流程监控、制定安全规范、提升用户意识以及深化国际合作，可以有效降低攻击风险，保护国家网络安全和信息资产。同时，此类攻击也提醒我们，网络安全形势日趋严峻，必须不断升级防御体系，以应对日益复杂的高级威胁。只有通过全社会的共同努力，才能在数字化时代构建更加坚固的安全防线。

**出处**：Volexity has identified a series of advanced social engineering operations by suspected Russian threat actors targeting Microsoft 365 (M365) OAuth authentication flows. The campaigns, which began in March 2025, represent a concerning evolution in phishing techniques—leveraging legitimate Microsoft authentication infrastructure to gain unauthorized access to victim accounts.