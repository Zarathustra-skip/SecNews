### 警惕！CatB 勒索软件利用微软分布式事务协调器实施恶意攻击的分析报告

#### 一、事件概述

自2022年末以来，CatB 勒索软件（又称 CatB99 或 Baxtoy）作为一种新型网络威胁迅速崛起，其通过利用微软分布式事务协调器（MSDTC）进行动态链接库（DLL）劫持，实施复杂而隐蔽的恶意攻击。CatB 不仅具备传统勒索软件的文件加密功能，还能窃取浏览器数据和用户凭据，并通过先进的检测机制规避虚拟机环境，给网络安全防御带来巨大挑战。更令人担忧的是，研究显示 CatB 与疑似网络间谍组织 ChamelGang（又称 CamoFei）存在关联，表明其攻击目标可能从单纯的经济勒索转向复杂的间谍活动。本文将从事件背景、技术机制、影响分析及应对策略等方面，深入探讨 CatB 勒索软件的威胁特征，并从中国视角分析其对我国网络安全的影响及应对之道。

#### 二、事件描述与分析

##### 2.1 CatB 勒索软件的背景与特征

CatB 勒索软件自2022年末首次被发现以来，因其高超的规避检测能力和独特的攻击手法而备受关注。安全研究人员发现，CatB 与 Pandora 勒索软件在勒索赎金通知和操作模式上存在惊人相似之处，推测 CatB 可能是 Pandora 的策略性更名或变种。这种恶意软件的目标涵盖全球范围内的知名组织，攻击手法复杂且多阶段，通常在执行文件加密前进行系统侦察，以收集目标系统的关键信息。

CatB 的核心威胁在于其不仅局限于传统的文件加密勒索，还具备窃取浏览器数据和用户凭据的能力。这种多功能性使其威胁程度显著提升。此外，CatB 具备先进的反检测机制，能够识别并绕过虚拟机环境，这为安全研究人员分析和遏制其行为带来了巨大挑战。SentinelOne 和 Fortinet 等安全机构分别在2023年3月和2月发布的报告中指出，CatB 能够系统性地破坏安全防御，并在被入侵的网络中实现长期潜伏。

##### 2.2 技术机制：DLL 搜索顺序劫持

CatB 勒索软件的执行策略以利用 Windows 系统的 DLL 搜索顺序机制为核心，通过攻击微软分布式事务协调器（MSDTC）实现 DLL 劫持。在 MITRE ATT&CK 框架中，这种技术被归类为 T1574.001，允许攻击者将恶意 DLL 加载到受信任的系统二进制文件中，从而借助合法进程执行恶意代码。

具体而言，CatB 的攻击流程包括以下几个关键步骤：

1. **初步侦察**：CatB 释放器首先通过调用 GetSystemInfo 和 DeviceIoControl 等 API 收集目标系统的硬件规格和驱动器信息。此外，它还利用 GlobalMemoryStatusEx API 获取物理内存和虚拟内存的详细信息，以判断是否运行在虚拟机环境中，从而规避沙箱分析。
2. **DLL 劫持**：CatB 利用 Windows 系统可预测的 DLL 加载顺序（优先搜索应用程序目录，再检查系统目录），将与合法 DLL 同名的恶意 DLL 放置在搜索顺序靠前的位置，确保其恶意代码以受信任应用程序的权限执行。
3. **禁用防御机制**：一旦恶意 DLL 被加载，CatB 会通过 PowerShell 命令终止与安全相关的进程，禁用目标系统的防御措施，为后续的加密操作和数据窃取创造条件。
4. **多重威胁执行**：在完成上述步骤后，CatB 不仅对文件进行加密，还窃取浏览器数据和用户凭据，进一步扩大其破坏范围。

这种 DLL 劫持机制的复杂性在于其隐蔽性和高权限执行能力。CatB 通过伪装成合法进程运行，极大地降低了被传统安全工具检测的可能性。此外，其侦察能力和反虚拟机技术进一步增加了防御难度。

##### 2.3 与网络间谍组织的关联

AttackIQ 的研究人员发现，CatB 勒索软件与疑似网络间谍组织 ChamelGang（CamoFei）存在关联。这一发现标志着威胁行为者战术的重大演变，即从传统的经济勒索转向结合复杂间谍活动目标的混合攻击模式。表面上的勒索软件攻击可能只是一个“烟幕弹”，其真实目的是掩盖潜在的情报收集活动。

这种混合攻击模式对网络安全防御提出了新的挑战。传统的勒索软件防御策略往往聚焦于数据备份和恢复，而忽视了潜在的数据窃取和间谍活动。CatB 的这种双重威胁特性使其成为一个更加复杂和危险的对手。

##### 2.4 攻击影响与全球范围

CatB 的攻击目标遍及全球，其多阶段攻击方法使其能够在目标网络中长期潜伏并造成重大损失。SentinelOne 和 Fortinet 的报告均指出，CatB 能够系统性地破坏安全防御，并在被入侵的网络中实现持续存在。其攻击不仅导致数据加密和经济损失，还可能引发敏感信息泄露，对目标组织的声誉和运营造成深远影响。

为应对这一威胁，AttackIQ 发布了一个攻击图，模拟 CatB 的战术、技术和操作流程（TTPs），帮助组织验证自身安全控制措施的有效性。这种主动防御方法使安全团队能够在漏洞被实际利用前发现并修复潜在风险。

#### 三、对我国影响分析研判

##### 3.1 网络安全威胁的直接影响

CatB 勒索软件的出现对我国网络安全构成了多层次的威胁。首先，作为一个高度工业化和数字化发展的国家，我国拥有大量依赖 Windows 系统的企业和政府机构。CatB 利用 MSDTC 进行 DLL 劫持的技术手段，可能直接威胁到这些系统的安全稳定运行。特别是在金融、能源、制造等关键基础设施领域，一旦遭受 CatB 攻击，可能导致数据泄露、业务中断甚至系统瘫痪，造成巨大的经济损失。

其次，CatB 的数据窃取功能对我国企业和个人的隐私安全构成严重威胁。我国是全球最大的互联网用户市场，浏览器数据和用户凭据的泄露可能被用于进一步的网络钓鱼、身份盗用或其他恶意活动。此外，若 CatB 攻击者将窃取的数据用于商业间谍活动或出售给第三方，将对我国企业的核心竞争力造成长期损害。

##### 3.2 潜在的间谍活动风险

CatB 与 ChamelGang 等网络间谍组织的关联，增加了其对我国国家安全的潜在威胁。近年来，网络间谍活动已成为国际博弈的重要手段，针对政府机构、科研单位和关键企业的攻击频发。CatB 的混合攻击模式可能被用于掩盖情报收集活动，窃取涉及国家安全的核心数据或技术机密。这种威胁在当前复杂的国际环境下尤为严峻，可能对我国的科技发展和国际竞争力产生深远影响。

##### 3.3 社会经济层面的间接影响

CatB 勒索软件的攻击不仅直接影响受害组织，还可能引发社会经济层面的连锁反应。例如，关键基础设施的瘫痪可能导致供应链中断，影响社会正常运转；企业因数据泄露或业务中断而遭受的经济损失，可能进一步波及员工就业和市场信心。此外，勒索软件攻击的频发可能削弱公众对数字化转型的信任，阻碍我国数字经济的发展进程。

##### 3.4 网络安全防御能力的挑战

CatB 的先进规避技术和复杂攻击机制，对我国网络安全防御能力提出了更高要求。当前，我国部分企业和机构在网络安全投入、技术能力和应急响应机制方面仍存在不足，难以有效应对 CatB 这样的新型威胁。此外，CatB 的反虚拟机检测能力增加了安全分析的难度，可能导致威胁情报的获取和共享滞后，进一步削弱整体防御效果。

#### 四、应对策略

##### 4.1 技术层面的防御措施

针对 CatB 勒索软件的技术特性，我国企业和机构应采取以下技术措施加强防御：

1. **加强系统安全配置**：对 Windows 系统的 DLL 加载顺序进行严格管控，限制非受信任目录的 DLL 加载，减少 DLL 劫持的风险。同时，定期更新操作系统和安全补丁，修复已知漏洞。
2. **部署行为检测工具**：传统的签名式防病毒软件难以检测 CatB 的隐蔽攻击行为，建议部署基于行为分析的端点检测与响应（EDR）工具，实时监控异常进程和文件操作。
3. **增强虚拟机检测对抗**：针对 CatB 的反虚拟机检测能力，安全团队应优化沙箱环境，模拟真实系统特征，降低恶意软件的规避成功率。
4. **数据备份与恢复机制**：建立完善的离线数据备份机制，确保在遭受勒索软件攻击后能够快速恢复关键数据，减少赎金支付的压力。

##### 4.2 组织层面的管理策略

除了技术手段，组织层面的管理策略同样至关重要：

1. **提升员工安全意识**：通过定期的网络安全培训，提高员工对勒索软件和网络钓鱼攻击的识别能力，减少因人为失误导致的感染风险。
2. **建立应急响应机制**：制定详细的网络安全事件应急预案，明确攻击发生后的响应流程和责任分工，确保在最短时间内控制损失。
3. **加强供应链安全管理**：CatB 可能通过供应链攻击传播，企业和机构应加强对供应商和合作伙伴的网络安全审查，确保整个生态系统的安全。

##### 4.3 国家层面的政策支持

在国家层面，我国应进一步完善网络安全政策和法律框架，为应对 CatB 等新型威胁提供保障：

1. **推动威胁情报共享**：建立国家级网络安全威胁情报共享平台，促进政府、企业和研究机构之间的信息交流，提升对新型威胁的快速响应能力。
2. **加大网络安全投入**：通过政策支持和资金投入，鼓励企业加强网络安全技术研发和基础设施建设，提升整体防御水平。
3. **加强国际合作**：CatB 的攻击目标具有全球性，我国应积极参与国际网络安全合作，与其他国家共同打击跨国网络犯罪，共享威胁情报和技术资源。

##### 4.4 行业协作与技术创新

针对 CatB 的复杂威胁，行业协作和技术创新是不可或缺的应对手段。我国网络安全行业应加强与国际安全机构的合作，借鉴 AttackIQ 等组织发布的攻击图和模拟工具，验证和改进自身防御措施。同时，鼓励国内安全企业研发针对 DLL 劫持和反虚拟机技术的创新解决方案，提升对新型勒索软件的检测和防御能力。

#### 五、结论

CatB 勒索软件的出现标志着网络威胁的进一步升级，其利用微软分布式事务协调器进行 DLL 劫持的技术手段，以及与网络间谍组织的潜在关联，使其成为一个复杂而危险的对手。从中国视角来看，CatB 对我国网络安全、国家安全和社会经济构成了多重威胁，亟需从技术、组织、国家和行业等多个层面采取综合应对措施。通过加强系统安全配置、提升员工安全意识、完善应急响应机制以及推动国际合作，我国能够有效降低 CatB 勒索软件的威胁，保障数字经济和国家安全的稳定发展。未来，随着网络威胁的不断演变，我国应持续关注新型攻击技术的发展动态，保持防御策略的前瞻性和适应性，为构建更加安全的网络空间奠定坚实基础。

#### 六、出处

本文内容基于安全KER平台发布的文章《警惕！CatB 利用微软分布式事务协调器实施恶意攻击》，原文翻译自 cybersecuritynews，原文链接：https://cybersecuritynews.com/catb-ransomware-leveraging-microsoft-distributed-transaction-coordinator/。如需转载，请注明出处。