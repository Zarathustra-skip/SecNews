# 隐匿的威胁：伪装成开源项目的活跃“投毒”事件分析

## 一、概述

近年来，网络安全领域面临着一种隐匿而危险的新型威胁：攻击者利用开源生态的信任，在GitHub等平台上伪装成合法的开源项目进行恶意代码“投毒”。据安天CERT监测，自2024年底以来，这种攻击活动持续活跃，攻击者通过伪装成漏洞利用工具、游戏外挂等吸引用户下载，并在Visual Studio项目编译配置中植入恶意代码。恶意代码通过多层混淆加载，最终执行使用Electron打包的远控木马，对用户系统构成严重威胁。目前，相关攻击活动仍在持续，样本中载荷下载URL等基础设施仍可访问，且在各类杀毒引擎中的检出率较低，仅安天AVL SDK反病毒引擎等少数安全工具能够有效识别和拦截。本文将围绕这一事件展开详细分析，探讨其攻击手法、对中国网络安全的影响及应对策略。

## 二、事件描述分析

### 攻击活动背景及手法

开源软件生态系统作为全球开发者共享资源的重要平台，因其开放性和信任机制而广受青睐。然而，这一特性也成为攻击者实施恶意活动的“沃土”。攻击者通过在GitHub上创建伪装成合法开源项目的仓库，吸引目标用户下载并编译代码，从而实现恶意代码的植入和执行。根据安天CERT的监测，此类攻击主要针对下载、编译和使用开源项目的开发者和用户群体，尤其是在软件开发、游戏玩家等高活跃度领域。

攻击者精心设计了伪装项目，内容多为漏洞利用工具、游戏外挂、虚拟货币窃取器等具有高吸引力的工具。这些项目被上传至GitHub后，攻击者利用GitHub Action功能，通过自动提交代码更新项目日期，使其始终显示为“最近更新”，从而增加受害者下载的可能性。提交代码中使用的硬编码邮箱地址“ischhfd83@rambler.ru”成为追踪攻击者的重要线索。

### 恶意代码植入与触发机制

恶意代码的植入方式极为隐蔽，攻击者将其嵌入Visual Studio项目的编译配置中，具体利用的是PreBuildEvent机制。这一机制允许在项目编译前执行指定的命令行代码，相关配置存储在项目文件（如.vcproj、.vbproj等）中。由于这些配置无法通过检查源代码直接发现，开发者在审查代码时往往难以察觉异常。当用户下载并编译这些伪装项目时，恶意代码便会悄然触发。

触发后，恶意代码通过Bat脚本、PowerShell脚本以及Base64、AES等加密算法，嵌套执行多层后续载荷。其流程包括从pastebin、rlim等公开网站获取下载地址，下载加密压缩包并解压，随后执行其中的主程序SearchFilter.exe。该程序由Electron打包，实际运行的是高度混淆的JavaScript代码，具备通过Telegram API回传系统信息、反虚拟机检测、关闭Windows Defender、屏幕截图、计划任务持久化以及下载后续载荷等远控功能。

### 攻击样本特征及其危害

本次攻击活动中涉及的恶意开源项目数量众多，覆盖游戏外挂、远控木马、虚拟货币窃取器等多种类型。安天CERT通过关联攻击手法及提交代码邮箱地址，发现了数十个包含恶意代码的GitHub项目，创建时间从数天到数月不等，表明攻击活动具有持续性和组织性。部分项目名称及伪装类型已在报告中列出，例如AurelienConte/Helldivers2-Internal-Cheat-FULL（游戏外挂）、BlackStons/AsyncRAT-Dark-Mode（远控木马）等。这些项目一旦被下载并编译，可能导致用户系统被完全控制，敏感数据泄露，甚至成为攻击者进一步攻击的跳板。

此外，攻击者利用Electron打包的asar格式文件分发恶意载荷。ASAR（Atom Shell Archive）是一种常用于Electron应用程序的档案格式，类似于ZIP或TAR，能够将多个资源文件打包成单一文件。由于其复杂性和混淆特性，传统杀毒引擎难以对其内部的恶意脚本进行精准检测。据统计，目前大多数杀毒引擎对这些恶意项目的检出率较低，仅安天AVL SDK反病毒引擎通过全格式精准识别和深度预处理技术，支持对asar文件中内嵌的恶意脚本进行细粒度拆解和检测。

### 攻击活动的持续性与隐蔽性

从样本基础设施的可访问性及项目创建时间的分布来看，此类攻击活动仍在活跃中。攻击者通过多层混淆技术和公开网站分发载荷，有效规避了传统安全工具的检测。同时，恶意代码的触发依赖于编译行为，而不是直接执行，这使得攻击更具针对性和隐蔽性。普通用户或开发者在下载并编译看似合法的项目时，往往缺乏足够的警惕性，极易成为攻击目标。

## 三、对我国影响分析研判

### 对国内开源生态安全的威胁

中国作为一个信息技术快速发展的大国，拥有庞大的软件开发者和开源社区用户群体。GitHub作为全球最大的开源代码托管平台，在国内开发者中具有广泛影响力。攻击者利用开源项目的信任机制进行“投毒”，对我国开源生态安全构成了严重威胁。国内开发者在开发软件或学习新技术时，经常需要下载和使用开源项目，一旦误下载恶意项目，可能导致个人或企业数据泄露，甚至影响整个开发环境的信任基础。更严重的是，部分恶意代码具备持久化能力和远控功能，可能被攻击者用于构建僵尸网络，进而对国家关键基础设施发起攻击。

### 对企业和个人的潜在风险

对于企业而言，此类攻击可能导致核心代码或商业机密泄露，尤其是一些依赖开源组件进行开发的企业，一旦编译环节被植入恶意代码，可能造成供应链攻击，影响整个产品生态。对于个人用户，特别是游戏玩家和普通开发者，恶意项目可能窃取账号信息、虚拟资产或个人隐私数据，造成经济损失和心理压力。值得注意的是，国内用户对网络安全防护的意识和能力参差不齐，部分用户缺乏对开源项目的审查能力，容易成为攻击者的首要目标。

### 对国家网络安全的长远影响

从国家网络安全的角度看，此类攻击活动暴露了开源生态在信任机制上的脆弱性。如果攻击者持续利用这一漏洞实施大规模攻击，可能对我国网络空间安全造成系统性风险。例如，攻击者可能通过控制大量受感染设备，发起分布式拒绝服务（DDoS）攻击，或利用窃取的数据进行间谍活动，威胁国家安全。此外，开源项目“投毒”事件还可能损害国内用户对开源生态的信心，影响我国软件开发行业的创新活力和技术进步。

### 国内安全防护能力的现状评估

目前，我国网络安全领域在应对新型威胁方面取得了较大进展，但面对此类伪装性强、技术复杂的攻击，仍然存在一定短板。传统杀毒引擎在检测Electron打包的asar格式文件及编译配置中的恶意代码时，往往效果有限。安天AVL SDK反病毒引擎等少数安全工具能够有效识别此类威胁，但总体来看，国内安全产品的覆盖率和响应速度仍有待提升。同时，企业和个人用户在使用开源项目时的安全意识和规范性不足，缺乏有效的防护措施和应急机制。

## 四、应对策略

### 加强开源项目的安全审查

为应对开源项目“投毒”威胁，建议国内开发者在使用GitHub等平台下载项目时，严格审查代码来源和项目背景。可以通过查看项目提交历史、贡献者信息及社区反馈，初步判断项目是否可信。对于涉及编译的项目，应仔细检查项目配置文件，特别是Visual Studio项目的PreBuildEvent设置，避免触发隐藏的恶意命令。此外，建议开发者优先选择经过官方认证或社区广泛验证的项目，降低下载恶意代码的风险。

### 提升安全工具的检测能力

针对Electron打包的asar格式文件及复杂混淆技术，国内安全厂商应加快技术研发，提升反病毒引擎对新型威胁的检测能力。安天AVL SDK反病毒引擎通过全格式精准识别和深度预处理技术，已在检测此类威胁方面取得一定成效，其他安全厂商可借鉴类似技术，开发支持细粒度文件拆解和恶意脚本识别的工具。同时，建议安全厂商加强与开源社区的合作，及时更新威胁情报库，共享攻击样本和IoCs（Indicators of Compromise），提升整体防护水平。

### 部署终端安全防护产品

企业和个人用户应部署专业的终端安全防护产品，实时监测本地新增文件和启动行为，发现恶意代码时及时告警并处置。安天智甲终端防御系统依托自研威胁检测引擎和内核级主动防御能力，能够有效查杀本次发现的远控木马样本，并通过统一管理平台集中查看和批量处置网内威胁事件。建议企业定期进行网络内病毒扫描，确保恶意代码无法在系统中潜伏。此外，个人用户可安装轻量级杀毒软件，定期更新病毒库，避免下载来源不明的文件。

### 加强用户安全教育和意识培养

提升用户的安全意识是防范此类攻击的重要环节。政府、企业和行业组织应加强网络安全教育，普及开源项目使用的安全规范，帮助用户识别伪装项目的特征。例如，提醒用户警惕“最近更新”频繁但缺乏实质内容更新的项目，避免盲目下载游戏外挂或漏洞利用工具等高风险内容。同时，可通过举办网络安全培训、发布安全警示等方式，增强开发者和普通用户的防护能力。

### 完善国家层面的网络安全政策

从国家层面看，应进一步完善网络安全法律法规，加强对开源生态的监管和治理。建议相关部门建立开源项目安全审查机制，对国内常用的开源平台和项目进行定期检测，发现恶意项目时及时向公众发出预警。此外，可推动国际合作，与其他国家和地区共享威胁情报，共同打击利用开源生态实施的网络攻击活动。通过政策引导和技术支持，构建更加安全、可信的开源生态体系。

## 五、结论

伪装成开源项目的“投毒”事件是一种新型、高隐蔽性的网络攻击手段，攻击者利用开源生态的信任机制，通过Visual Studio项目编译配置植入恶意代码，最终执行Electron打包的远控木马，对用户系统和数据安全构成严重威胁。此类攻击活动在我国具有广泛影响，可能导致个人隐私泄露、企业数据丢失，甚至对国家网络安全造成系统性风险。面对这一威胁，国内应从开源项目审查、安全工具开发、终端防护部署、用户教育及国家政策完善等多方面入手，构建全面的防护体系。通过企业和个人的共同努力，以及政府和行业组织的支持，我们有信心有效遏制此类攻击，保障开源生态的安全与可持续发展。

**出处来源**：  
- GitHub开源项目被投毒，后门病毒跟随开发流程传播蔓延 [R/OL].(2025-01-23)  
  https://mp.weixin.qq.com/s/MF2lvyH6BxBE_muCwkOCPg