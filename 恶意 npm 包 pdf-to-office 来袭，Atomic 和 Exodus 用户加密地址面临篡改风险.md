# 恶意 npm 包 pdf-to-office 来袭：Atomic 和 Exodus 用户加密地址篡改风险的深度分析

## 引言

随着数字化进程的加速，软件供应链安全已成为网络安全领域的重要议题。2025年4月11日，安全资讯平台“安全KER”发布了一篇关于恶意 npm 包“pdf-to-office”的报道，揭示了威胁行为者通过 Node.js 包管理器（npm）注册表上传恶意软件包，针对加密货币钱包软件 Atomic Wallet 和 Exodus 的用户实施地址篡改攻击的风险。这一事件不仅凸显了软件供应链攻击的隐蔽性和破坏性，也为全球开发者、用户以及相关企业敲响了警钟。本文将从事件描述、技术分析、国际视角对中国的影响以及应对策略等多个维度，深入探讨这一安全威胁的本质及其深远影响。

## 事件描述

### 事件背景

根据“安全KER”翻译自 The Hacker News 的报道，威胁行为者近年来持续利用 npm 注册表作为攻击载体，通过上传伪装成合法工具的恶意软件包，篡改本地已安装的库版本并执行恶意代码。这种攻击方式被认为是软件供应链攻击的一种隐蔽形式，相较于传统的网络攻击，其隐蔽性和持久性更强。

2025年3月24日，一个名为“pdf-to-office”的 npm 软件包首次发布，表面上宣称是一款将 PDF 文件转换为 Microsoft Word 文档的实用工具。然而，安全研究人员发现，该软件包实则暗藏恶意代码，专门针对加密货币钱包软件 Atomic Wallet 和 Exodus 的特定版本（Atomic Wallet 2.91.5 和 2.90.6 版本，Exodus 25.13.3 和 25.9.2 版本），通过篡改钱包目标地址，将用户的加密货币资金转移至攻击者控制的地址。

### 攻击机制

ReversingLabs 的研究员 Lucija Valentić 在报告中详细描述了“pdf-to-office”的攻击机制。该软件包通过检查 Windows 系统“AppData/Local/Programs”文件夹内是否存在“atomic/resources/app.asar”归档文件，判断目标计算机是否安装了 Atomic Wallet。如果确认安装，恶意代码会用篡改后的文件覆盖原有文件，将资金发送的目标地址替换为攻击者通过 Base64 编码的 Web3 钱包地址。类似地，该软件包还会针对 Exodus 钱包的“src/app/ui/index.js”文件进行篡改。

值得注意的是，即使“pdf-to-office”软件包被删除，其对钱包软件的篡改效果依然存在，唯一的解决办法是完全卸载并重新安装钱包软件。截至报道发布时，该软件包的最新版本 1.1.2（2025年4月8日上传）仍可供下载，累计下载量已达334次。

### 相关事件

在“pdf-to-office”事件披露前几周，ReversingLabs 还发现了另外两个恶意 npm 软件包“ethers-provider2”和“ethers-providerz”，这些软件包通过建立反向 Shell 与攻击者服务器通信，感染本地已安装的软件包。此外，ExtensionTotal 报告了10个恶意的 Visual Studio Code 扩展程序，这些扩展程序在被下架前累计安装量超过百万次，主要用于加密货币挖矿。

## 技术分析：攻击手段与特点

### 软件供应链攻击的隐蔽性

软件供应链攻击近年来成为网络犯罪分子的首选手段之一，其核心在于利用开发者对第三方库和工具的信任，通过污染开源软件包或扩展程序，在用户不知不觉中植入恶意代码。与传统的恶意软件传播方式（如钓鱼邮件或恶意下载）相比，软件供应链攻击具有以下特点：

1. **隐蔽性强**：攻击者将恶意代码嵌入看似合法的软件包中，普通用户和开发者难以察觉。例如，“pdf-to-office”伪装成文档转换工具，降低了用户的戒备心理。
2. **持久性高**：即使恶意软件包被删除，其对目标系统的篡改可能依然存在，如“pdf-to-office”对钱包软件文件的修改。
3. **影响范围广**：npm 作为全球开发者广泛使用的包管理器，任何恶意软件包的传播都可能影响大量用户和企业。

### 针对加密货币钱包的精准攻击

“pdf-to-office”攻击的一个显著特点是其针对性。攻击者明确选择了 Atomic Wallet 和 Exodus 这两款主流加密货币钱包软件，并精准锁定特定版本。这种策略表明攻击者对目标软件的代码结构和版本特性有深入了解，能够确保恶意代码准确覆盖关键文件。

此外，攻击者通过 Base64 编码隐藏其 Web3 钱包地址，进一步增加了追踪和溯源的难度。这种技术手段不仅体现了攻击者的专业性，也反映了加密货币领域已成为网络犯罪的高价值目标。

### 攻击的持久化机制

“pdf-to-office”攻击的另一个技术亮点在于其持久化机制。即使软件包本身被卸载，其对钱包软件的篡改依然有效。这种设计充分利用了用户对软件更新和卸载的认知盲区，使得受害者难以察觉资金被转移的原因。

## 多视角分析

### 技术视角：软件供应链安全的脆弱性

从技术角度看，“pdf-to-office”事件暴露了软件供应链安全的脆弱性。npm 作为一个开源生态系统，虽然为开发者提供了便利，但其审核机制和安全检测能力明显不足。攻击者能够轻易上传恶意软件包，并在短时间内更新多个版本，表明平台对软件包内容的安全性验证存在明显短板。

此外，攻击者利用了开发者对第三方库的依赖心理。许多开发者在项目中直接引用 npm 软件包，而未对其来源和内容进行严格审查。这种信任机制为攻击者提供了可乘之机。

### 经济视角：加密货币领域的犯罪动机

从经济角度分析，加密货币的高价值和匿名性使其成为网络犯罪分子的主要目标。通过篡改钱包地址，攻击者能够直接窃取用户的数字资产，且由于区块链交易的不可逆性，受害者几乎无法追回损失。据统计，2023年全球加密货币相关犯罪造成的损失已超过50亿美元，而类似“pdf-to-office”的攻击手段无疑进一步加剧了这一趋势。

### 社会视角：用户安全意识的不足

从社会角度看，用户安全意识的不足是此类攻击成功的重要原因。许多加密货币用户缺乏对软件来源的警惕性，容易下载未经验证的工具或扩展程序。此外，用户对钱包软件的更新和维护也缺乏足够的重视，导致攻击者能够利用版本漏洞实施精准打击。

### 法律与监管视角：跨国犯罪的挑战

从法律和监管角度看，“pdf-to-office”事件凸显了跨国网络犯罪的复杂性。npm 作为一个全球性平台，其用户和攻击者可能分布在不同国家，法律管辖和执法协作面临巨大挑战。此外，加密货币的去中心化特性也使得资金追踪和追责变得异常困难。

## 国际视角：对中国的影响

### 软件供应链安全对中国科技产业的潜在威胁

中国作为全球科技产业的重要参与者，拥有庞大的开发者社区和加密货币用户群体。npm 软件包在中国开发者中广泛使用，尤其是在前端开发和区块链相关项目中。如果类似“pdf-to-office”的恶意软件包被中国开发者或企业无意中引入，可能对国内软件供应链安全造成严重威胁。

例如，中国许多区块链初创企业和加密货币交易平台依赖于开源工具和第三方库。如果这些工具被污染，可能导致用户资金被盗，进而损害企业声誉和用户信任。此外，软件供应链攻击还可能被用于窃取敏感数据或植入后门，对国家信息安全构成潜在威胁。

### 加密货币用户群体的直接风险

中国拥有全球最大的加密货币用户群体之一，尽管国内对加密货币交易有严格监管，但仍有大量用户通过海外平台或去中心化钱包进行交易。Atomic Wallet 和 Exodus 作为国际上流行的钱包软件，在中国用户中也有一定市场份额。类似“pdf-to-office”的攻击可能直接威胁这些用户的资产安全。

更重要的是，由于中国用户在国际网络安全事件中的信息获取可能存在滞后性，部分用户可能未能及时获知相关风险提示，从而成为攻击者的目标。

### 国际合作与竞争中的网络安全挑战

从国际视角看，“pdf-to-office”事件也反映了中国在全球网络安全合作与竞争中的挑战。一方面，中国需要与国际社会加强合作，共同应对软件供应链攻击等跨国网络威胁；另一方面，网络安全领域的技术竞争也可能导致部分国家或组织利用类似攻击手段对中国企业或用户实施针对性打击。

例如，软件供应链攻击可能被用作经济间谍活动的一部分，窃取中国企业的核心代码或商业机密。这种潜在威胁要求中国在技术自主可控和国际合作之间找到平衡。

## 应对策略

### 技术层面的防护措施

1. **加强软件包审核与检测**：npm 等开源平台应引入更严格的软件包审核机制，利用自动化工具对上传内容进行恶意代码检测。同时，开发者在引用第三方库时，应使用代码签名和哈希校验等技术，确保软件包来源可信。
2. **提升终端安全防护**：针对加密货币钱包用户，建议使用硬件钱包存储资产，避免将私钥存储在联网设备上。此外，用户应定期更新钱包软件，并避免安装未经验证的工具或扩展程序。
3. **开发安全意识培训工具**：为开发者提供安全意识培训和工具，帮助其识别潜在的恶意软件包。例如，可以开发插件或服务，实时扫描 npm 软件包的安全性。

### 企业层面的风险管理

1. **建立供应链安全管理体系**：企业应将软件供应链安全纳入整体风险管理体系，定期对使用的第三方库和工具进行安全评估，确保其来源和内容可信。
2. **加强员工安全培训**：企业应定期对员工进行网络安全培训，提升其对软件供应链攻击的认知和防范能力。
3. **制定应急响应计划**：针对可能发生的软件供应链攻击，企业应制定详细的应急响应计划，确保在发现恶意软件包后能够迅速隔离受影响系统并修复漏洞。

### 政府与国际合作层面的对策

1. **加强网络安全立法与监管**：中国政府应进一步完善网络安全相关法律法规，明确软件供应链安全的监管要求和责任划分。同时，可考虑建立国家级软件供应链安全检测平台，为企业和开发者提供支持。
2. **推动国际合作**：中国应积极参与国际网络安全合作，与其他国家共同制定软件供应链安全标准，打击跨国网络犯罪。例如，可通过国际组织如联合国或亚太经合组织（APEC）推动相关议题的讨论。
3. **支持自主可控技术研发**：在软件供应链安全领域，中国应加大对自主可控技术的研发投入，减少对国际开源平台的过度依赖。例如，可推动国产包管理器和开发工具的普及。

### 用户层面的自我保护

1. **谨慎选择软件来源**：用户在下载工具或扩展程序时，应优先选择官方渠道或经过验证的来源，避免使用不明来源的软件包。
2. **定期检查钱包安全**：加密货币用户应定期检查钱包软件的版本和交易记录，确保目标地址未被篡改。一旦发现异常，应立即停止使用并重新安装软件。
3. **提升安全意识**：用户应关注网络安全资讯，了解最新的攻击手段和防护方法，避免成为攻击者的目标。

## 结论

“pdf-to-office”恶意 npm 包事件是软件供应链攻击的一个典型案例，揭示了开源生态系统在安全管理上的不足，以及加密货币领域面临的严峻安全挑战。从技术、经济、社会和法律等多个视角分析，这一事件不仅对个体用户和企业构成直接威胁，也对全球网络安全格局和中国信息安全环境产生深远影响。

面对这一挑战，中国需要在技术防护、企业管理、政府监管和国际合作等多个层面采取综合措施，提升软件供应链安全水平，保护用户和企业的合法权益。同时，开发者、用户和相关机构也应提高安全意识，共同应对日益复杂的网络威胁。只有通过多方协作，才能有效遏制软件供应链攻击的蔓延，构建更加安全的数字生态系统。

---

**出处**：本文基于“安全KER - 安全资讯平台”发布的文章《恶意 npm 包 pdf-to-office 来袭，Atomic 和 Exodus 用户加密地址面临篡改风险》（原文链接：https://www.anquanke.com/post/id/306482，翻译自 The Hacker News，原文地址：https://thehackernews.com/2025/04/malicious-npm-package-targets-atomic.html）进行分析和撰写。