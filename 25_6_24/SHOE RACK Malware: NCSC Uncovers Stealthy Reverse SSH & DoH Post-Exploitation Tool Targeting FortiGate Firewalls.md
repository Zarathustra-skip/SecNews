 # 鞋架恶意软件：潜伏威胁FortiGate防火墙的新型网络攻击工具及应对之策

## 一、事件概述

近期，英国国家网络安全中心(NCSC)披露了一种名为"鞋架"(Shoe Rack)的新型恶意软件，该软件以其隐蔽性强、功能多样化而引人关注。这款后渗透工具专门针对FortiGate防火墙设备，利用反向SSH和基于DNS的HTTPS(DoH)技术建立隐蔽通信通道，为攻击者提供持久访问权限。鞋架恶意软件的出现标志着网络攻击手段的不断进化，对全球网络安全环境构成了新的挑战，特别是对依赖FortiGate设备的组织和关键基础设施的安全防护提出了更高要求。

## 二、事件详细分析

### 1. 鞋架恶意软件的技术特点

鞋架恶意软件是一种高度专业化的后渗透工具，其技术特点主要表现在以下几个方面：

首先，该恶意软件采用了反向SSH技术，这使攻击者能够绕过传统的网络防御措施，建立从被攻击设备到攻击者控制服务器的隐蔽连接。这种反向连接方式让防火墙难以察觉异常流量，因为连接是从内部网络向外发起的。

其次，鞋架恶意软件创新性地使用了基于DNS的HTTPS(DoH)技术进行通信。DoH技术将DNS查询封装在HTTPS流量中，使恶意通信混合在正常网络流量中，极难被传统安全监控工具识别和拦截。这种通信方式显著提高了攻击的隐蔽性。

第三，该恶意软件针对FortiGate防火墙的具体架构和功能进行了定制化设计，能够有效规避FortiGate自身的安全检测机制，同时实现对设备的持久控制。

### 2. 攻击手法与影响范围

攻击者通常首先需要获取FortiGate设备的初始访问权限，可能利用已知漏洞、弱密码或社会工程学等手段。一旦获取初始访问权限，攻击者便可植入鞋架恶意软件，建立持久后门。

NCSC的报告指出，鞋架恶意软件主要被用于以下几类活动：
- 窃取敏感数据和网络配置信息
- 监控网络流量和用户活动
- 为后续横向移动提供跳板
- 建立长期潜伏的网络据点

从影响范围来看，FortiGate防火墙产品在全球范围内广泛应用于企业、政府机构以及关键基础设施，因此该恶意软件的潜在受害者遍布全球。特别是那些使用FortiGate设备作为网络边界防护的组织面临较高风险。目前尚未确定该恶意软件的主要传播地区，但考虑到其技术复杂性，很可能是由具备高级技术能力的威胁行为者操控。

### 3. 攻击者背景分析

根据NCSC提供的信息，鞋架恶意软件展现出高度专业化的特征，表明其背后可能是国家支持的黑客组织或高级持续性威胁(APT)组织。这类组织通常拥有充足的资源和技术能力，能够开发如此复杂的攻击工具。

虽然NCSC尚未明确指出该恶意软件的具体来源，但从其技术特点和攻击目标来看，很可能是针对特定行业或关键基础设施的有组织攻击行为，而非普通的网络犯罪活动。这种高级别网络攻击通常具有明确的情报收集或战略目标，值得高度关注。

## 三、对中国的影响分析研判

### 1. 对中国网络安全环境的直接影响

FortiGate防火墙在中国市场拥有相当份额，尤其在大型企业、金融机构和政府部门中应用广泛。鞋架恶意软件的出现，对使用FortiGate产品的中国组织构成直接威胁。一旦这些设备被攻击者控制，不仅会导致敏感数据泄露，还可能成为攻击者进一步渗透内网的跳板。

特别值得关注的是，随着中国数字经济的快速发展，越来越多的关键信息基础设施依赖网络安全设备保障安全运行。如果这些设备被攻破，可能对国家安全和经济发展造成严重影响。

### 2. 对中国网络安全产业的启示

鞋架恶意软件的出现，再次凸显了对国外网络安全产品过度依赖的潜在风险。这一事件为中国加快网络安全自主可控进程提供了新的论据。同时，也暴露出当前安全监测手段对于高级隐蔽通信渠道的检测能力不足的问题。

此外，这类针对网络设备的攻击手法日益复杂化、专业化的趋势，对中国网络安全产业提出了新的技术挑战。国内安全厂商需要加强对DNS隧道、DoH技术滥用等高级攻击技术的研究，提升检测和防御能力。

### 3. 对中国网络空间治理的影响

鞋架恶意软件作为一种可能由国家级别支持的攻击工具，其出现进一步复杂化了全球网络空间的安全形势。这对中国参与全球网络空间治理、推动制定合理的国际网络安全规则提出了新的课题。

同时，这类高级攻击工具的扩散也增加了网络空间的不稳定性，可能导致各国之间网络安全互信机制的削弱。在这一背景下，中国需要积极推动国际合作，共同应对此类复杂网络威胁。

## 四、应对策略

### 1. 技术防御措施

针对鞋架恶意软件这类高级威胁，建议采取以下技术防御措施：

- **加强设备安全配置**：对FortiGate设备进行安全加固，定期更新固件至最新版本，禁用不必要的服务和端口，实施最小权限原则。
- **部署高级流量分析系统**：引入能够识别异常DNS查询和加密流量特征的高级流量分析系统，重点关注DoH流量和可疑的出站连接。
- **实施网络分段**：对网络进行合理分段，限制防火墙管理接口的访问范围，防止攻击者获取初始访问权限。
- **建立多层次的检测机制**：结合主机和网络层面的安全监测手段，形成多维度的检测体系，提高对隐蔽通道的发现能力。
- **部署蜜罐系统**：在关键网络区域部署针对性的蜜罐系统，诱导攻击者暴露行为，及早发现潜在威胁。

### 2. 管理措施与政策建议

除技术手段外，还需加强以下管理措施：

- **建立健全的安全运营中心(SOC)**：构建专业的安全运营团队，实施7×24小时的安全监控，及时响应可疑事件。
- **制定设备采购安全评估机制**：对关键网络设备的采购实施严格的安全评估，促进国产替代，减少对单一国外厂商的依赖。
- **加强供应链安全管理**：对网络设备供应链进行全面安全审查，避免引入预置后门或漏洞。
- **完善网络安全应急响应机制**：制定专门针对网络设备被控制的应急预案，定期开展演练，提高快速响应能力。
- **推动国际合作与信息共享**：积极参与国际网络安全信息共享平台，及时获取威胁情报，共同应对高级威胁。

### 3. 长期战略规划

从长远角度看，应着重推进以下战略举措：

- **加大网络安全核心技术研发投入**：支持国内企业研发具有自主知识产权的网络安全设备和系统，提升技术自主可控水平。
- **培养网络安全高端人才**：加强网络安全专业人才培养，特别是具备高级威胁分析和应对能力的专业人才。
- **构建国家级网络安全态势感知平台**：整合各行业网络安全数据，提升对国家关键信息基础设施的整体防护能力。
- **完善网络安全法律法规体系**：针对新型网络攻击手段，不断更新完善相关法律法规，为网络安全工作提供法律保障。
- **探索建立可信网络设备认证机制**：推动建立具有国际影响力的网络设备安全认证标准和机制，提高设备安全可信度。

## 五、结论

鞋架恶意软件的出现代表了当前网络攻击技术向更加隐蔽、精准方向发展的趋势。这类针对网络关键设备的后渗透工具，凭借其高度隐蔽性和持久性，对全球网络安全环境构成了严峻挑战。对中国而言，这一事件既是警示，也是推动网络安全能力建设的契机。

面对日益复杂的网络安全威胁，中国需要在技术防御、管理措施和长期战略三个层面同步发力。一方面加强对现有网络设备的安全防护，提升检测和响应能力；另一方面加快推进网络安全核心技术的自主创新，减少对外部技术的依赖。同时，应积极参与国际合作，共同应对全球网络安全挑战。

通过系统性、前瞻性的应对措施，中国不仅能够有效防范类似鞋架恶意软件的高级威胁，还能借此推动国内网络安全产业的发展壮大，提升国家网络空间安全治理能力。在数字经济深入发展的背景下，这对保障国家安全和经济社会发展具有重要战略意义。